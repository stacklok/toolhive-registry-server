# Example configuration for syncing from an API endpoint
#
# This configuration pulls registry data from the official MCP Registry API
# and syncs it to the local storage every hour.
#
# The API source type is useful for:
#   - Aggregating data from multiple upstream registries
#   - Consuming data from other ToolHive Registry API instances
#   - Integrating with third-party MCP registry services
#
# Usage:
#   thv-registry-api serve --config examples/config-api.yaml

# Registry name/identifier (optional, defaults to "default")
registryName: mcp-registry

# Registries configuration (can have multiple registries)
registries:
  - name: mcp-upstream
    # Data format: only 'upstream' is supported for API sources
    format: upstream

    # API endpoint configuration
    api:
      # Base API URL (without path)
      # The sync manager will append the appropriate API paths:
      #   - /v0.1/servers - List all servers (with pagination support)
      #   - /v0.1/servers/{name}/versions - List server versions
      #   - /v0.1/servers/{name}/versions/{version} - Get specific version

      endpoint: https://registry.modelcontextprotocol.io

    # Per-registry automatic synchronization policy
    syncPolicy:
      # Sync interval (valid duration: 1m, 5m, 30m, 1h, 24h, etc.)
      # Less frequent for upstream API to be respectful of external services
      interval: "1h"

auth:
  mode: anonymous

# PostgreSQL database configuration
# Store registry data in database instead of local files
database:
  # For docker-compose: use service name 'postgres'
  # For local development: use 'localhost'
  host: postgres
  port: 5432
  # Application user with limited privileges (SELECT, INSERT, UPDATE, DELETE)
  user: db_app
  # Migration user with elevated privileges (CREATE, ALTER, DROP)
  migrationUser: db_migrator
  # Credentials are provided via pgpass file (see docker-compose.yaml)
  database: registry
  # For docker-compose: disable SSL for local network
  # For production: use 'require' or 'verify-full'
  sslMode: disable
  # Connection pool settings
  maxOpenConns: 10
  maxIdleConns: 2
  connMaxLifetime: "30m"

# Optional: Filter configuration to include/exclude specific servers
# This is especially useful when syncing from upstream to curate
# a subset of servers for your organization
# filter:
#   # Name-based filtering
#   names:
#     # Only include servers matching these patterns (glob syntax)
#     include:
#       - "@modelcontextprotocol/*"
#       - "anthropic/*"
#     # Exclude servers matching these patterns
#     exclude:
#       - "*/experimental"
#
#   # Tag-based filtering
#   tags:
#     # Only include servers with these tags
#     include:
#       - "official"
#       - "verified"
#     # Exclude servers with these tags
#     exclude:
#       - "alpha"
#       - "unmaintained"
