# Use distroless/static which includes CA certificates for TLS verification
defaultBaseImage: gcr.io/distroless/static:nonroot

builds:
  - id: thv-registry-api
    dir: ./cmd/thv-registry-api
    ldflags:
      - -s -w
      - -X github.com/stacklok/toolhive-registry-server/internal/versions.Version={{.Env.VERSION}}
      - -X github.com/stacklok/toolhive-registry-server/internal/versions.Commit={{.Env.COMMIT}}
      - -X github.com/stacklok/toolhive-registry-server/internal/versions.BuildDate={{.Env.BUILD_DATE}}
      - -X github.com/stacklok/toolhive-registry-server/internal/versions.BuildType=release
